<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='This function is an internal function used by "mage". The function will calculate the Mean Amplitude of Glycemic Excursions (MAGE) on all the values of the inputted data set. To calculate separate MAGE values for a group of subjects, use the "mage" function.'><title>Calculates Mean Amplitude of Glycemic Excursions (see "mage") — mage_ma_single • iglu</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculates Mean Amplitude of Glycemic Excursions (see " mage mage_ma_single><meta property="og:description" content='This function is an internal function used by "mage". The function will calculate the Mean Amplitude of Glycemic Excursions (MAGE) on all the values of the inputted data set. To calculate separate MAGE values for a group of subjects, use the "mage" function.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">iglu</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/iglu.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/AGP_and_Episodes.html">AGP and Episodes</a>
    <a class="dropdown-item" href="../articles/lasagna_plots.html">Lasagna Plots in iglu</a>
    <a class="dropdown-item" href="../articles/MAGE.html">MAGE Algorithm</a>
    <a class="dropdown-item" href="../articles/metrics_list.html">List of metrics implemented in iglu</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/irinagain/iglu/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculates Mean Amplitude of Glycemic Excursions (see "mage")</h1>
      <small class="dont-index">Source: <a href="https://github.com/irinagain/iglu/blob/HEAD/R/mage_ma_single.R" class="external-link"><code>R/mage_ma_single.R</code></a></small>
      <div class="d-none name"><code>mage_ma_single.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is an internal function used by "mage". The function will calculate the Mean Amplitude of Glycemic Excursions (MAGE) on <strong>all</strong> the values of the inputted data set. To calculate separate MAGE values for a group of subjects, use the "mage" function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mage_ma_single</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  short_ma <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  long_ma <span class="op">=</span> <span class="fl">32</span>,</span>
<span>  return_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"num"</span>, <span class="st">"df"</span><span class="op">)</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avg"</span>, <span class="st">"service"</span>, <span class="st">"max"</span>, <span class="st">"plus"</span>, <span class="st">"minus"</span><span class="op">)</span>,</span>
<span>  dt0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tz <span class="op">=</span> <span class="st">""</span>,</span>
<span>  inter_gap <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  max_gap <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  show_ma <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_excursions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ggplot"</span>, <span class="st">"plotly"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>DataFrame object with column names "id", "time", and "gl". Should only be data for 1 subject. In case multiple subject ids are detected, a warning is produced and only 1st subject is used.</p></dd>


<dt>short_ma</dt>
<dd><p>Integer for period length of the short moving average. <strong>Default: 5.</strong> Must be positive and less than "long_ma". (Recommended &lt;15)</p></dd>


<dt>long_ma</dt>
<dd><p>Integer for period length for the long moving average. <strong>Default: 32.</strong> Must be positive and greater than "short_ma". (Recommended &gt;20)</p></dd>


<dt>return_type</dt>
<dd><p>One of "num" or "df". <strong>Default: "num".</strong> Will return either a single number for the "MAGE over the entire trace" (weighted by segment length) or a DataFrame with the MAGE value for each segment (see the MAGE vignette for discussion of handling gaps by splitting trace into multiple segments).</p></dd>


<dt>direction</dt>
<dd><p>One of "avg", "service", "max", "plus", or "minus". <strong>Default: "avg".</strong> Algorithm will calculate one of the following: MAGE+ (nadir to peak), MAGE- (peak to nadir), MAGEavg = avg(MAGE+, MAGE-), MAGEmax = max(MAGE+, MAGE-), or automatically choose MAGE+/MAGE- based on the first countable excursion (i.e., "service"). NOTE: the selection of peak-to-nadir or nadir-to-peak is chosen independently on each segment, thus MAGEservice may choose peak-to-nadir on one segment and nadir-to-peak on another, for example.</p></dd>


<dt>dt0</dt>
<dd><p>The time frequency for interpolation in minutes, the default will match the CGM meter's frequency (e.g. 5 min for Dexcom).</p></dd>


<dt>tz</dt>
<dd><p>A character string specifying the time zone to be used. System-specific (see <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></code>), but " " is the current time zone, and "GMT" is UTC (Universal Time, Coordinated). Invalid values are most commonly treated as UTC, on some platforms with a warning.</p></dd>


<dt>inter_gap</dt>
<dd><p>The maximum allowable gap (in minutes) for interpolation. The values will not be interpolated between the glucose measurements that are more than inter_gap minutes apart. The default value is 45 min.</p></dd>


<dt>max_gap</dt>
<dd><p>Integer for the maximum length of a gap in minutes before the trace is split into segments and MAGE is calculated on each segment independently. <strong>Default: 180.</strong></p></dd>


<dt>plot</dt>
<dd><p>Boolean. <strong>Default: FALSE.</strong> If TRUE, returns a plot that visualizes all identified peaks and nadirs, excursions, and  missing gaps. An interactive GUI can be loaded with <code>plot_type = 'plotly'</code>.</p></dd>


<dt>title</dt>
<dd><p>Title for the ggplot. <strong>Default: "Glucose Trace - Subject [ID]".</strong></p></dd>


<dt>xlab</dt>
<dd><p>Label for x-axis of ggplot. <strong>Default: "Time".</strong></p></dd>


<dt>ylab</dt>
<dd><p>Label for y-axis of ggplot. <strong>Default: "Glucose Level".</strong></p></dd>


<dt>show_ma</dt>
<dd><p>Boolean. <strong>Default: FALSE.</strong> If TRUE, plots the moving average lines on the plot.</p></dd>


<dt>show_excursions</dt>
<dd><p>Boolean. <strong>Default: TRUE.</strong> If TRUE, shows identified excursions as arrows from peak-to-nadir/nadir-to-peak on the plot.</p></dd>


<dt>plot_type</dt>
<dd><p>One of "ggplot" or "plotly". <strong>Default: "gglplot".</strong> Returns either a ggplot (static image) or Plotly chart (interactive GUI).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A ggplot or Plotly chart if <code>plot = TRUE</code>, depending on <code>plot_type</code>. Otherwise, a numeric MAGE value for the inputted glucose trace or a DataFrame with the MAGE values on each segment, depending on <code>return_type</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See "mage".</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nathaniel J. Fernandes</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_data_1_subject</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mage_ma_single</span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="va">example_data_1_subject</span>,</span></span>
<span class="r-in"><span>   short_ma <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>   long_ma <span class="op">=</span> <span class="fl">24</span>,</span></span>
<span class="r-in"><span>   direction <span class="op">=</span> <span class="st">'plus'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 73.47135</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mage_ma_single</span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="va">example_data_1_subject</span>,</span></span>
<span class="r-in"><span>   inter_gap <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 79.72259</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mage_ma_single</span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="va">example_data_1_subject</span>,</span></span>
<span class="r-in"><span>   plot<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   title<span class="op">=</span><span class="st">"Patient X"</span>,</span></span>
<span class="r-in"><span>   xlab<span class="op">=</span><span class="st">"Time"</span>,</span></span>
<span class="r-in"><span>   ylab<span class="op">=</span><span class="st">"Glucose Level (mg/dL)"</span>,</span></span>
<span class="r-in"><span>   show_ma<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mage_ma_single-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Elizabeth Chun, Steve Broll, David Buchanan, John Muschelli, Nathaniel Fernandes, Irina Gaynanova.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

