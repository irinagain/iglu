<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lasagna Plots in iglu • iglu</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lasagna Plots in iglu">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iglu</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/iglu.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/AGP_and_Episodes.html">AGP and Episodes</a></li>
    <li><a class="dropdown-item" href="../articles/lasagna_plots.html">Lasagna Plots in iglu</a></li>
    <li><a class="dropdown-item" href="../articles/MAGE.html">MAGE Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/metrics_list.html">List of metrics implemented in iglu</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/irinagain/iglu/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lasagna Plots in iglu</h1>
                        <h4 data-toc-skip class="author">Steve Broll,
Elizabeth Chun, Irina Gaynanova, David Buchanan</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/irinagain/iglu/blob/master/vignettes/lasagna_plots.Rmd" class="external-link"><code>vignettes/lasagna_plots.Rmd</code></a></small>
      <div class="d-none name"><code>lasagna_plots.Rmd</code></div>
    </div>

    
    
<p>The <code>plot_glu</code> function supports lasagna plots by changing
the ‘plottype’ parameter. For more on lasagna plots, see <a href="https://doi.org/10.1097/ede.0b013e3181e5b06a" class="external-link">Swihart et
al. (2010) “Lasagna Plots: A Saucy Alternative to Spaghetti Plots.”</a>.
The lasagna plots in iglu can be single-subject or multi-subject. The
single-subject lasagna plot has rows corresponding to each day of
measurements with a color grid indicating glucose values.</p>
<p>The highest glucose values are displayed in red, whereas the lowest
are displayed in blue. Thus, the numerical glucose values are mapped to
color using the gradient from blue to red, which corresponds to the
default ‘blue-red’ color scheme. An alternative ‘red-orange’ color
scheme can be selected by the user by corresponding modification of the
‘color_scheme’ parameter.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://irinagain.github.io/iglu/">iglu</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, datatype <span class="op">=</span> <span class="st">"single"</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, datatype <span class="op">=</span> <span class="st">"single"</span>, color_scheme <span class="op">=</span> <span class="st">"red-orange"</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
<p>For plots with a single subject, setting the datatype parameter to
“single” will display a plot where the rows represent days.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, datatype <span class="op">=</span> <span class="st">'single'</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>We can additionally sort the values at each time point by setting
<code>lasagnatype = 'timesorted'</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, datatype <span class="op">=</span> <span class="st">'single'</span>, lasagnatype <span class="op">=</span> <span class="st">'timesorted'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>To average across days at each time point, we can use
<code>datatype = 'average'</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, datatype <span class="op">=</span> <span class="st">'average'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>You can also produce plots for multiple subjects, by using data with
multiple values for “id”. By default, this will produce an unsorted
lasagna plot using up to 14 days worth of data with each subject
displayed in separate rows.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_5_subject</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>This works for all the above options sans datatype = single.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_5_subject</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, color_scheme <span class="op">=</span> <span class="st">"red-orange"</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_5_subject</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, lasagnatype <span class="op">=</span> <span class="st">'timesorted'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_5_subject</span>, plottype <span class="op">=</span> <span class="st">'lasagna'</span>, datatype <span class="op">=</span> <span class="st">'average'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>Lasagna plots are also an excellent way to visualize gaps in data.
The inter_gap parameter controls the maximum length of time (in minutes)
between glucose readings for interpolation to occur between them. See
how more gaps appear in the plot below as inter_gap shrinks.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, plottype <span class="op">=</span><span class="st">"lasagna"</span>, datatype <span class="op">=</span> <span class="st">"single"</span>, inter_gap <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, plottype <span class="op">=</span><span class="st">"lasagna"</span>, datatype <span class="op">=</span> <span class="st">"single"</span>, inter_gap <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_glu.html">plot_glu</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, plottype <span class="op">=</span><span class="st">"lasagna"</span>, datatype <span class="op">=</span> <span class="st">"single"</span>, inter_gap <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>For further customization of lasagna plots, use the
<code>plot_lasagna</code> and <code>plot_lasagna_1subject</code>
functions.</p>
<p>Within plot_lasagna, the “midpoint” parameter specifies the glucose
value (in mg/dL) at which the color transitions from blue to red (the
default is 105 mg/dL), and the “limit” parameter specifies the range
(the default is [50, 500] mg/dL)</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_lasagna.html">plot_lasagna</a></span><span class="op">(</span><span class="va">example_data_5_subject</span>, datatype <span class="op">=</span> <span class="st">"average"</span>, midpoint <span class="op">=</span> <span class="fl">140</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">400</span><span class="op">)</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p><code>plot_lasagna</code> allows for multi-subject lasagna plots with
the additional options of sorting the hours by glucose values for each
subject, i.e. horizontal sorting, by setting
<code>lasagnatype = 'subjectsorted'</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_lasagna.html">plot_lasagna</a></span><span class="op">(</span><span class="va">example_data_5_subject</span>, datatype <span class="op">=</span> <span class="st">'average'</span>, lasagnatype <span class="op">=</span> <span class="st">'subjectsorted'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p><code>plot_lasagna</code> also supports changing the maximum number
of days to display, as well as the upper and lower target range limits
(LLTR and ULTR), midpoint, and minimum and maximum values to display,
all of which will affect the colorbar.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_lasagna.html">plot_lasagna</a></span><span class="op">(</span><span class="va">example_data_5_subject</span>, datatype <span class="op">=</span> <span class="st">'average'</span>, lasagnatype <span class="op">=</span> <span class="st">'subjectsorted'</span>, LLTR <span class="op">=</span> <span class="fl">100</span>, ULTR <span class="op">=</span> <span class="fl">180</span>, midpoint <span class="op">=</span> <span class="fl">150</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">500</span><span class="op">)</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p><code>plot_lasagna_1subject</code> allows for customization of the
more detailed single subject lasagna plots. There is no datatype
parameter for <code>plot_lasagna_1subject</code>, but there are three
types of plots available, accessed with the <code>lasagnatype</code>
parameter.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_lasagna_1subject.html">plot_lasagna_1subject</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, lasagnatype <span class="op">=</span> <span class="st">'unsorted'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_lasagna_1subject.html">plot_lasagna_1subject</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, lasagnatype <span class="op">=</span> <span class="st">'timesorted'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_lasagna_1subject.html">plot_lasagna_1subject</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, lasagnatype <span class="op">=</span> <span class="st">'daysorted'</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>As with the <code>lasagna_plot</code> function, changing the LLTR,
ULTR, midpoint, and limits parameters will affect the colorbar.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_lasagna_1subject.html">plot_lasagna_1subject</a></span><span class="op">(</span><span class="va">example_data_1_subject</span>, lasagnatype <span class="op">=</span> <span class="st">'daysorted'</span>, midpoint <span class="op">=</span> <span class="fl">150</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">500</span><span class="op">)</span>, tz <span class="op">=</span> <span class="st">'EST'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 14 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<p><img src="lasagna_plots_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Elizabeth Chun, Steve Broll, David Buchanan, John Muschelli, Nathaniel Fernandes, Irina Gaynanova.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
